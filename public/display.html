<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>ğŸŸï¸ ç¾å ´å‰©é¤˜ç¥¨æ•¸</title>
<link rel="stylesheet" href="style.css">
<script src="/socket.io/socket.io.js"></script>
</head>
<body class="display">

  <img class="banner" src="banner.png" alt="æ©«å¹…">
  <div class="divider"></div>
  <div class="ticket-title">ğŸŸï¸ ç¾å ´å‰©é¤˜ç¥¨æ•¸</div>


  <!-- ç¥¨æ•¸é¡¯ç¤ºå€ -->
  <div id="display" class="ticket-container"></div>

  <script>
const socket = io();
let lastData = {};

socket.on('update', data => {
  const container = document.getElementById('display');
  const title = document.querySelector('.ticket-title');
  container.innerHTML = '';

  // âœ… å–å¾—å‰©é¤˜ç¥¨æ•¸ç¸½å’Œ
  const remainingValues = Object.values(data.remaining || {});
  const totalRemaining = remainingValues.reduce((sum, n) => sum + n, 0);

  // âœ… è‹¥å…¨å€éƒ½å”®å®Œ
  if (totalRemaining === 0) {
    title.textContent = 'ğŸš« ç¥¨å·²å…¨éƒ¨å”®å®Œ';
    container.style.display = 'none';
    return; // ä¸å†æ¸²æŸ“ç¥¨å¡
  } else {
    title.textContent = 'ğŸŸï¸ ç¾å ´å‰©é¤˜ç¥¨æ•¸';
    container.style.display = 'flex';
  }

  // âœ… æ­£å¸¸é¡¯ç¤ºå„å€ç¥¨æ•¸
  for (let zone in data.remaining) {
    const num = data.remaining[zone];
    const div = document.createElement('div');
    div.className = 'ticket-card';

    const h2 = document.createElement('h2');
    h2.textContent = `${zone} å€`;

    const p = document.createElement('p');
    p.textContent = num;

    if (num === 0) p.classList.add('zero');
    if (lastData[zone] !== undefined && lastData[zone] !== num) {
      p.classList.add('number-animate');
      p.addEventListener('animationend', () => p.classList.remove('number-animate'), { once: true });
    }

    div.appendChild(h2);
    div.appendChild(p);
    container.appendChild(div);
  }

  lastData = { ...data.remaining };
});
</script>

  
</body>
</html>
